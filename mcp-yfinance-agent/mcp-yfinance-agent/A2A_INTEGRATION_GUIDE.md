# A2A (AI-to-AI) ì—°ë™ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

ì´ ë¬¸ì„œëŠ” ë‹¤ë¥¸ AI ì—ì´ì „íŠ¸ë“¤ì´ ìš°ë¦¬ì˜ íˆ¬ì ë¶„ì„ ì‹œìŠ¤í…œê³¼ A2A(AI-to-AI) í†µì‹ ì„ í†µí•´ ì—°ë™í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê°€ì´ë“œì…ë‹ˆë‹¤.

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ì™¸ë¶€ AI       â”‚    â”‚   ì™¸ë¶€ AI       â”‚    â”‚   ì™¸ë¶€ AI       â”‚
â”‚   ì—ì´ì „íŠ¸ A    â”‚    â”‚   ì—ì´ì „íŠ¸ B    â”‚    â”‚   ì—ì´ì „íŠ¸ C    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
          â”‚     A2A Protocol     â”‚                      â”‚
          â”‚     (WebSocket/HTTP) â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚      A2A Integration          â”‚
            â”‚         Manager               â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚    Specialized Adapters       â”‚
            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”â”‚
            â”‚  â”‚Investmentâ”‚  Risk   â”‚Portfolioâ”‚
            â”‚  â”‚ Adapter  â”‚ Adapter â”‚Adapter â”‚â”‚
            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚     Core AI Agents            â”‚
            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”â”‚
            â”‚  â”‚Investmentâ”‚  Risk   â”‚Portfolioâ”‚
            â”‚  â”‚  Agent   â”‚ Agent   â”‚ Agent â”‚â”‚
            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1. ì„œë²„ ì—°ê²°

ìš°ë¦¬ ì‹œìŠ¤í…œì— ì—°ê²°í•˜ë ¤ë©´ ë‹¤ìŒ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”:

```python
# WebSocket ì—°ê²°
WEBSOCKET_ENDPOINTS = {
    "investment": "ws://localhost:8766",
    "risk": "ws://localhost:8767", 
    "portfolio": "ws://localhost:8768"
}

# HTTP API ì—°ê²°
HTTP_ENDPOINT = "http://localhost:8000/a2a"
```

### 2. ê¸°ë³¸ ì—°ê²° ì˜ˆì œ

```python
import asyncio
import websockets
import json

async def connect_to_investment_agent():
    """íˆ¬ì ë¶„ì„ ì—ì´ì „íŠ¸ì— ì—°ê²°"""
    uri = "ws://localhost:8766"
    
    async with websockets.connect(uri) as websocket:
        # ì—°ê²° í™•ì¸
        print("âœ… íˆ¬ì ë¶„ì„ ì—ì´ì „íŠ¸ì— ì—°ê²°ë¨")
        
        # ë©”ì‹œì§€ ìˆ˜ì‹  ëŒ€ê¸°
        async for message in websocket:
            data = json.loads(message)
            print(f"ğŸ“¨ ìˆ˜ì‹ : {data}")
            break

# ì—°ê²° ì‹¤í–‰
asyncio.run(connect_to_investment_agent())
```

## ğŸ“¡ A2A í”„ë¡œí† ì½œ

### ë©”ì‹œì§€ êµ¬ì¡°

```json
{
  "message_id": "msg_1703123456_001",
  "sender_id": "your_agent_id",
  "receiver_id": "investment_agent_001",
  "message_type": "request",
  "priority": "high",
  "timestamp": "2024-12-21T10:30:00Z",
  "payload": {
    "ticker": "AAPL",
    "analysis_type": "comprehensive",
    "timeframe": "1m",
    "user_profile": {
      "risk_tolerance": "moderate",
      "investment_horizon": "short_term"
    }
  },
  "correlation_id": null,
  "expires_at": "2024-12-21T10:35:00Z"
}
```

### ë©”ì‹œì§€ íƒ€ì…

| íƒ€ì… | ì„¤ëª… | ì‚¬ìš© ì˜ˆì‹œ |
|------|------|-----------|
| `request` | ë¶„ì„ ìš”ì²­ | ì£¼ì‹ ë¶„ì„, í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ |
| `response` | ë¶„ì„ ì‘ë‹µ | ë¶„ì„ ê²°ê³¼ ë°˜í™˜ |
| `error` | ì—ëŸ¬ ì‘ë‹µ | ì²˜ë¦¬ ì‹¤íŒ¨ ì‹œ |
| `heartbeat` | ì—°ê²° ìƒíƒœ í™•ì¸ | ì£¼ê¸°ì  ì—°ê²° í™•ì¸ |
| `registration` | ì—ì´ì „íŠ¸ ë“±ë¡ | ìƒˆë¡œìš´ ì—ì´ì „íŠ¸ ë“±ë¡ |

### ìš°ì„ ìˆœìœ„

| ë ˆë²¨ | ê°’ | ì„¤ëª… |
|------|-----|------|
| `low` | 1 | ì¼ë°˜ì ì¸ ìš”ì²­ |
| `normal` | 2 | ê¸°ë³¸ ìš”ì²­ |
| `high` | 3 | ê¸´ê¸‰í•œ ë¶„ì„ ìš”ì²­ |
| `critical` | 4 | ë§¤ìš° ì¤‘ìš”í•œ ìš”ì²­ |

## ğŸ”§ API ì‚¬ìš©ë²•

### 1. ì£¼ì‹ ë¶„ì„ ìš”ì²­

```python
async def request_stock_analysis(ticker: str, analysis_type: str = "comprehensive"):
    """ì£¼ì‹ ë¶„ì„ ìš”ì²­"""
    
    message = {
        "message_id": f"msg_{int(time.time())}",
        "sender_id": "your_agent_id",
        "receiver_id": "investment_agent_001",
        "message_type": "request",
        "priority": "high",
        "timestamp": datetime.now().isoformat(),
        "payload": {
            "ticker": ticker,
            "analysis_type": analysis_type,  # "technical", "fundamental", "comprehensive"
            "timeframe": "1m",  # "1d", "1w", "1m", "3m", "1y"
            "user_profile": {
                "risk_tolerance": "moderate",
                "investment_horizon": "short_term",
                "trading_style": "swing_trading"
            }
        }
    }
    
    # WebSocketìœ¼ë¡œ ì „ì†¡
    async with websockets.connect("ws://localhost:8766") as websocket:
        await websocket.send(json.dumps(message))
        
        # ì‘ë‹µ ìˆ˜ì‹ 
        response = await websocket.recv()
        result = json.loads(response)
        return result

# ì‚¬ìš© ì˜ˆì‹œ
result = await request_stock_analysis("AAPL", "comprehensive")
print(f"AAPL ë¶„ì„ ê²°ê³¼: {result}")
```

### 2. ë¦¬ìŠ¤í¬ ë¶„ì„ ìš”ì²­

```python
async def request_risk_analysis(ticker: str):
    """ë¦¬ìŠ¤í¬ ë¶„ì„ ìš”ì²­"""
    
    message = {
        "message_id": f"msg_{int(time.time())}",
        "sender_id": "your_agent_id",
        "receiver_id": "risk_agent_001",
        "message_type": "request",
        "priority": "high",
        "timestamp": datetime.now().isoformat(),
        "payload": {
            "ticker": ticker,
            "event_sources": ["news", "financial_reports", "market_data"],
            "time_horizon": "1d",  # "1h", "1d", "1w", "1m"
            "severity_threshold": "medium"
        }
    }
    
    async with websockets.connect("ws://localhost:8767") as websocket:
        await websocket.send(json.dumps(message))
        response = await websocket.recv()
        return json.loads(response)

# ì‚¬ìš© ì˜ˆì‹œ
risk_result = await request_risk_analysis("TSLA")
print(f"TSLA ë¦¬ìŠ¤í¬ ë¶„ì„: {risk_result}")
```

### 3. í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ ìš”ì²­

```python
async def request_portfolio_analysis(user_id: str, portfolio_data: dict):
    """í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ ìš”ì²­"""
    
    message = {
        "message_id": f"msg_{int(time.time())}",
        "sender_id": "your_agent_id",
        "receiver_id": "portfolio_agent_001",
        "message_type": "request",
        "priority": "high",
        "timestamp": datetime.now().isoformat(),
        "payload": {
            "user_id": user_id,
            "portfolio_data": portfolio_data,
            "analysis_goals": ["risk_assessment", "optimization", "rebalancing"]
        }
    }
    
    async with websockets.connect("ws://localhost:8768") as websocket:
        await websocket.send(json.dumps(message))
        response = await websocket.recv()
        return json.loads(response)

# ì‚¬ìš© ì˜ˆì‹œ
portfolio_data = {
    "positions": [
        {"ticker": "AAPL", "quantity": 100, "average_price": 150.0},
        {"ticker": "GOOGL", "quantity": 50, "average_price": 2500.0}
    ],
    "cash": 10000.0
}

portfolio_result = await request_portfolio_analysis("user123", portfolio_data)
print(f"í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„: {portfolio_result}")
```

## ğŸ“Š ì‘ë‹µ í˜•ì‹

### ì£¼ì‹ ë¶„ì„ ì‘ë‹µ

```json
{
  "message_type": "response",
  "correlation_id": "msg_1703123456_001",
  "payload": {
    "ticker": "AAPL",
    "current_price": 193.50,
    "overall_score": 75.5,
    "risk_score": 25.0,
    "momentum_score": 80.0,
    "trend_score": 70.0,
    "recommendations": [
      {
        "action": "BUY",
        "confidence": 0.85,
        "reasoning": "ê°•í•œ ëª¨ë©˜í…€ê³¼ ê¸ì •ì  ì¶”ì„¸",
        "target_price": 210.0,
        "stop_loss": 180.0
      }
    ],
    "analysis_type": "comprehensive",
    "timestamp": "2024-12-21T10:30:00Z"
  }
}
```

### ë¦¬ìŠ¤í¬ ë¶„ì„ ì‘ë‹µ

```json
{
  "message_type": "response",
  "correlation_id": "msg_1703123456_002",
  "payload": {
    "ticker": "AAPL",
    "overall_risk_score": 24.0,
    "risk_level": "low",
    "total_events": 4,
    "high_risk_events": 0,
    "risk_factors": ["market_volatility"],
    "recommendations": [
      "ë‚®ì€ ë¦¬ìŠ¤í¬ ìƒíƒœì…ë‹ˆë‹¤. ìƒëŒ€ì ìœ¼ë¡œ ì•ˆì „í•œ íˆ¬ì í™˜ê²½ì…ë‹ˆë‹¤."
    ],
    "recent_events": [
      {
        "title": "AAPL ì‹¤ì  ë°œí‘œ, ì˜ˆìƒë³´ë‹¤ ë‚®ì€ ë§¤ì¶œ",
        "event_type": "market",
        "severity": "medium",
        "risk_score": 25,
        "source": "Financial News",
        "published_date": "2024-12-20T10:00:00Z"
      }
    ],
    "confidence_score": 0.8,
    "timestamp": "2024-12-21T10:30:00Z"
  }
}
```

### í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ ì‘ë‹µ

```json
{
  "message_type": "response",
  "correlation_id": "msg_1703123456_003",
  "payload": {
    "user_id": "user123",
    "overall_score": 68.5,
    "risk_metrics": {
      "portfolio_volatility": 0.25,
      "max_drawdown": 0.15,
      "sharpe_ratio": 1.2,
      "beta": 1.1
    },
    "performance_metrics": {
      "total_return": 12.5,
      "annualized_return": 15.2,
      "win_rate": 0.65
    },
    "recommendations": [
      {
        "action": "REBALANCE",
        "reasoning": "ì„¹í„° ì§‘ì¤‘ë„ê°€ ë†’ìŒ",
        "confidence": 0.7
      }
    ],
    "sector_allocation": {
      "Technology": 60.0,
      "Healthcare": 25.0,
      "Finance": 15.0
    },
    "timestamp": "2024-12-21T10:30:00Z"
  }
}
```

## ğŸ”— HTTP API ëŒ€ì•ˆ

WebSocket ëŒ€ì‹  HTTP APIë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:

### ì£¼ì‹ ë¶„ì„ HTTP ìš”ì²­

```python
import httpx

async def http_stock_analysis(ticker: str):
    """HTTP APIë¥¼ í†µí•œ ì£¼ì‹ ë¶„ì„"""
    
    async with httpx.AsyncClient() as client:
        response = await client.post(
            "http://localhost:8000/a2a/stock_analysis",
            json={
                "ticker": ticker,
                "analysis_type": "comprehensive",
                "timeframe": "1m",
                "user_profile": {
                    "risk_tolerance": "moderate",
                    "investment_horizon": "short_term"
                }
            },
            timeout=30.0
        )
        return response.json()

# ì‚¬ìš© ì˜ˆì‹œ
result = await http_stock_analysis("AAPL")
```

### ë¦¬ìŠ¤í¬ ë¶„ì„ HTTP ìš”ì²­

```python
async def http_risk_analysis(ticker: str):
    """HTTP APIë¥¼ í†µí•œ ë¦¬ìŠ¤í¬ ë¶„ì„"""
    
    async with httpx.AsyncClient() as client:
        response = await client.post(
            "http://localhost:8000/a2a/risk_analysis",
            json={
                "ticker": ticker,
                "event_sources": ["news", "financial_reports"],
                "time_horizon": "1d"
            },
            timeout=30.0
        )
        return response.json()
```

## ğŸ› ï¸ ì™„ì „í•œ ì˜ˆì œ

### ì™¸ë¶€ AI ì—ì´ì „íŠ¸ ì˜ˆì œ

```python
#!/usr/bin/env python3
"""
ì™¸ë¶€ AI ì—ì´ì „íŠ¸ê°€ ìš°ë¦¬ ì‹œìŠ¤í…œê³¼ ì—°ë™í•˜ëŠ” ì™„ì „í•œ ì˜ˆì œ
"""

import asyncio
import websockets
import json
import time
from datetime import datetime
from typing import Dict, Any, List

class ExternalAIAgent:
    """ì™¸ë¶€ AI ì—ì´ì „íŠ¸ ì˜ˆì œ"""
    
    def __init__(self, agent_id: str):
        self.agent_id = agent_id
        self.endpoints = {
            "investment": "ws://localhost:8766",
            "risk": "ws://localhost:8767",
            "portfolio": "ws://localhost:8768"
        }
    
    async def analyze_stock_comprehensive(self, ticker: str) -> Dict[str, Any]:
        """ì¢…í•©ì ì¸ ì£¼ì‹ ë¶„ì„"""
        print(f"ğŸ” {ticker} ì¢…í•© ë¶„ì„ ì‹œì‘...")
        
        # 1. íˆ¬ì ë¶„ì„ ìš”ì²­
        investment_result = await self._request_investment_analysis(ticker)
        
        # 2. ë¦¬ìŠ¤í¬ ë¶„ì„ ìš”ì²­
        risk_result = await self._request_risk_analysis(ticker)
        
        # 3. ê²°ê³¼ í†µí•©
        integrated_result = self._integrate_analysis(ticker, investment_result, risk_result)
        
        return integrated_result
    
    async def _request_investment_analysis(self, ticker: str) -> Dict[str, Any]:
        """íˆ¬ì ë¶„ì„ ìš”ì²­"""
        message = {
            "message_id": f"msg_{int(time.time())}_inv",
            "sender_id": self.agent_id,
            "receiver_id": "investment_agent_001",
            "message_type": "request",
            "priority": "high",
            "timestamp": datetime.now().isoformat(),
            "payload": {
                "ticker": ticker,
                "analysis_type": "comprehensive",
                "timeframe": "1m",
                "user_profile": {
                    "risk_tolerance": "moderate",
                    "investment_horizon": "short_term",
                    "trading_style": "swing_trading"
                }
            }
        }
        
        try:
            async with websockets.connect(self.endpoints["investment"]) as websocket:
                await websocket.send(json.dumps(message))
                response = await websocket.recv()
                result = json.loads(response)
                
                if result.get("message_type") == "response":
                    return result["payload"]
                else:
                    print(f"âŒ íˆ¬ì ë¶„ì„ ì‹¤íŒ¨: {result}")
                    return {}
                    
        except Exception as e:
            print(f"âŒ íˆ¬ì ë¶„ì„ ì—°ê²° ì‹¤íŒ¨: {e}")
            return {}
    
    async def _request_risk_analysis(self, ticker: str) -> Dict[str, Any]:
        """ë¦¬ìŠ¤í¬ ë¶„ì„ ìš”ì²­"""
        message = {
            "message_id": f"msg_{int(time.time())}_risk",
            "sender_id": self.agent_id,
            "receiver_id": "risk_agent_001",
            "message_type": "request",
            "priority": "high",
            "timestamp": datetime.now().isoformat(),
            "payload": {
                "ticker": ticker,
                "event_sources": ["news", "financial_reports", "market_data"],
                "time_horizon": "1d",
                "severity_threshold": "medium"
            }
        }
        
        try:
            async with websockets.connect(self.endpoints["risk"]) as websocket:
                await websocket.send(json.dumps(message))
                response = await websocket.recv()
                result = json.loads(response)
                
                if result.get("message_type") == "response":
                    return result["payload"]
                else:
                    print(f"âŒ ë¦¬ìŠ¤í¬ ë¶„ì„ ì‹¤íŒ¨: {result}")
                    return {}
                    
        except Exception as e:
            print(f"âŒ ë¦¬ìŠ¤í¬ ë¶„ì„ ì—°ê²° ì‹¤íŒ¨: {e}")
            return {}
    
    def _integrate_analysis(self, ticker: str, investment_result: Dict, risk_result: Dict) -> Dict[str, Any]:
        """ë¶„ì„ ê²°ê³¼ í†µí•©"""
        integrated = {
            "ticker": ticker,
            "timestamp": datetime.now().isoformat(),
            "external_agent_id": self.agent_id,
            "investment_analysis": investment_result,
            "risk_analysis": risk_result,
            "final_score": 0.0,
            "final_recommendation": "HOLD",
            "confidence": 0.0
        }
        
        # íˆ¬ì ë¶„ì„ ê²°ê³¼ ì²˜ë¦¬
        if investment_result:
            integrated["final_score"] += investment_result.get("overall_score", 50) * 0.7
            integrated["confidence"] = investment_result.get("confidence", 0.5)
            
            recommendations = investment_result.get("recommendations", [])
            if recommendations:
                integrated["final_recommendation"] = recommendations[0].get("action", "HOLD")
        
        # ë¦¬ìŠ¤í¬ ë¶„ì„ ê²°ê³¼ ì²˜ë¦¬
        if risk_result:
            risk_score = risk_result.get("overall_risk_score", 50)
            # ë¦¬ìŠ¤í¬ ì ìˆ˜ë¥¼ ë°˜ëŒ€ë¡œ ë³€í™˜ (ë†’ì€ ë¦¬ìŠ¤í¬ = ë‚®ì€ ì ìˆ˜)
            risk_penalty = (100 - risk_score) * 0.3
            integrated["final_score"] -= risk_penalty
            
            # ë¦¬ìŠ¤í¬ê°€ ë†’ìœ¼ë©´ ì¶”ì²œì„ ì¡°ì •
            if risk_score > 70:
                if integrated["final_recommendation"] == "BUY":
                    integrated["final_recommendation"] = "HOLD"
                elif integrated["final_recommendation"] == "STRONG_BUY":
                    integrated["final_recommendation"] = "BUY"
        
        # ìµœì¢… ì ìˆ˜ ì •ê·œí™”
        integrated["final_score"] = max(0, min(100, integrated["final_score"]))
        
        return integrated
    
    async def batch_analysis(self, tickers: List[str]) -> Dict[str, Any]:
        """ë°°ì¹˜ ë¶„ì„"""
        print(f"ğŸ“Š {len(tickers)}ê°œ ì¢…ëª© ë°°ì¹˜ ë¶„ì„ ì‹œì‘...")
        
        results = {}
        for ticker in tickers:
            try:
                result = await self.analyze_stock_comprehensive(ticker)
                results[ticker] = result
                print(f"âœ… {ticker}: {result['final_recommendation']} (ì ìˆ˜: {result['final_score']:.1f})")
            except Exception as e:
                print(f"âŒ {ticker} ë¶„ì„ ì‹¤íŒ¨: {e}")
                results[ticker] = {"error": str(e)}
        
        # ê²°ê³¼ ìš”ì•½
        successful_analyses = [r for r in results.values() if "error" not in r]
        if successful_analyses:
            best_stock = max(successful_analyses, key=lambda x: x["final_score"])
            worst_stock = min(successful_analyses, key=lambda x: x["final_score"])
            
            summary = {
                "total_analyzed": len(tickers),
                "successful": len(successful_analyses),
                "best_recommendation": best_stock,
                "worst_recommendation": worst_stock,
                "average_score": sum(r["final_score"] for r in successful_analyses) / len(successful_analyses),
                "results": results
            }
            
            print(f"\nğŸ“ˆ ë°°ì¹˜ ë¶„ì„ ì™„ë£Œ:")
            print(f"  ì„±ê³µë¥ : {len(successful_analyses)}/{len(tickers)}")
            print(f"  ìµœê³  ì¶”ì²œ: {best_stock['ticker']} (ì ìˆ˜: {best_stock['final_score']:.1f})")
            print(f"  í‰ê·  ì ìˆ˜: {summary['average_score']:.1f}")
            
            return summary
        
        return {"error": "ëª¨ë“  ë¶„ì„ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"}

async def main():
    """ë©”ì¸ í•¨ìˆ˜"""
    print("ğŸ¤– ì™¸ë¶€ AI ì—ì´ì „íŠ¸ A2A ì—°ë™ ì˜ˆì œ")
    print("=" * 50)
    
    # ì™¸ë¶€ ì—ì´ì „íŠ¸ ìƒì„±
    external_agent = ExternalAIAgent("external_agent_001")
    
    # ë‹¨ì¼ ì¢…ëª© ë¶„ì„
    print("\nğŸ” ë‹¨ì¼ ì¢…ëª© ë¶„ì„:")
    aapl_result = await external_agent.analyze_stock_comprehensive("AAPL")
    print(f"AAPL ë¶„ì„ ê²°ê³¼:")
    print(f"  ìµœì¢… ì ìˆ˜: {aapl_result['final_score']:.1f}")
    print(f"  ìµœì¢… ì¶”ì²œ: {aapl_result['final_recommendation']}")
    print(f"  ì‹ ë¢°ë„: {aapl_result['confidence']:.2f}")
    
    # ë°°ì¹˜ ë¶„ì„
    print(f"\nğŸ“Š ë°°ì¹˜ ë¶„ì„:")
    tickers = ["AAPL", "GOOGL", "MSFT", "TSLA", "META"]
    batch_result = await external_agent.batch_analysis(tickers)
    
    print(f"\nâœ… A2A ì—°ë™ ì˜ˆì œ ì™„ë£Œ!")

if __name__ == "__main__":
    asyncio.run(main())
```

## ğŸ”§ ì„œë²„ ì‹œì‘ ë°©ë²•

### 1. A2A ì„œë²„ ì‹œì‘

```bash
# A2A í†µí•© ì„œë²„ ì‹œì‘
cd /path/to/mcp-yfinance-agent/src
python3 a2a_integration.py

# ë˜ëŠ” ê°œë³„ ì—ì´ì „íŠ¸ ì„œë²„ ì‹œì‘
python3 a2a_adapter.py --type investment --port 8766
python3 a2a_adapter.py --type risk --port 8767  
python3 a2a_adapter.py --type portfolio --port 8768
```

### 2. í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
# ê°„ë‹¨í•œ A2A ë°ëª¨
python3 a2a_simple_demo.py

# ì „ì²´ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸
python3 a2a_test_suite.py

# ë°ëª¨ ëª¨ë“œ
python3 a2a_test_suite.py demo
```

## ğŸ“‹ ì—ëŸ¬ ì²˜ë¦¬

### ì¼ë°˜ì ì¸ ì—ëŸ¬ ì½”ë“œ

| ì—ëŸ¬ ì½”ë“œ | ì„¤ëª… | í•´ê²° ë°©ë²• |
|-----------|------|-----------|
| `CONNECTION_FAILED` | ì—°ê²° ì‹¤íŒ¨ | ì„œë²„ ìƒíƒœ í™•ì¸, ì—”ë“œí¬ì¸íŠ¸ í™•ì¸ |
| `TIMEOUT` | ìš”ì²­ ì‹œê°„ ì´ˆê³¼ | ìš”ì²­ íƒ€ì„ì•„ì›ƒ ì¦ê°€, ì„œë²„ ë¶€í•˜ í™•ì¸ |
| `INVALID_MESSAGE` | ì˜ëª»ëœ ë©”ì‹œì§€ í˜•ì‹ | ë©”ì‹œì§€ êµ¬ì¡° ê²€ì¦ |
| `AGENT_NOT_FOUND` | ì—ì´ì „íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ | ì—ì´ì „íŠ¸ ID í™•ì¸ |
| `ANALYSIS_FAILED` | ë¶„ì„ ì‹¤íŒ¨ | ìš”ì²­ íŒŒë¼ë¯¸í„° í™•ì¸ |

### ì—ëŸ¬ ì‘ë‹µ ì˜ˆì œ

```json
{
  "message_type": "error",
  "correlation_id": "msg_1703123456_001",
  "payload": {
    "error_code": "ANALYSIS_FAILED",
    "error_message": "ì¢…ëª© ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",
    "original_request": {
      "ticker": "INVALID_TICKER",
      "analysis_type": "comprehensive"
    }
  }
}
```

## ğŸš€ ê³ ê¸‰ ì‚¬ìš©ë²•

### 1. ë¹„ë™ê¸° ë°°ì¹˜ ì²˜ë¦¬

```python
async def batch_analysis_async(tickers: List[str]) -> Dict[str, Any]:
    """ë¹„ë™ê¸° ë°°ì¹˜ ë¶„ì„"""
    
    # ëª¨ë“  ìš”ì²­ì„ ë™ì‹œì— ì‹¤í–‰
    tasks = []
    for ticker in tickers:
        task = external_agent.analyze_stock_comprehensive(ticker)
        tasks.append(task)
    
    # ëª¨ë“  ë¶„ì„ ì™„ë£Œ ëŒ€ê¸°
    results = await asyncio.gather(*tasks, return_exceptions=True)
    
    # ê²°ê³¼ ì²˜ë¦¬
    processed_results = {}
    for i, result in enumerate(results):
        ticker = tickers[i]
        if isinstance(result, Exception):
            processed_results[ticker] = {"error": str(result)}
        else:
            processed_results[ticker] = result
    
    return processed_results
```

### 2. ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°

```python
async def real_time_analysis_stream(tickers: List[str]):
    """ì‹¤ì‹œê°„ ë¶„ì„ ìŠ¤íŠ¸ë¦¼"""
    
    async with websockets.connect("ws://localhost:8766") as websocket:
        # êµ¬ë… ë©”ì‹œì§€ ì „ì†¡
        subscribe_message = {
            "message_type": "subscribe",
            "payload": {
                "tickers": tickers,
                "stream_type": "real_time_analysis"
            }
        }
        await websocket.send(json.dumps(subscribe_message))
        
        # ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì‹ 
        async for message in websocket:
            data = json.loads(message)
            print(f"ğŸ“Š ì‹¤ì‹œê°„ ë¶„ì„: {data}")
```

## ğŸ“ ì§€ì› ë° ë¬¸ì˜

- **GitHub Repository**: [mcp-yfinance-agent](https://github.com/your-repo/mcp-yfinance-agent)
- **ë¬¸ì„œ**: [A2A Integration Guide](https://your-docs.com/a2a-guide)
- **ì´ìŠˆ ë¦¬í¬íŠ¸**: [GitHub Issues](https://github.com/your-repo/mcp-yfinance-agent/issues)

## ğŸ“ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” MIT ë¼ì´ì„ ìŠ¤ í•˜ì— ë°°í¬ë©ë‹ˆë‹¤.

---

**ğŸ’¡ íŒ**: ë” ë§ì€ ì˜ˆì œì™€ ê³ ê¸‰ ê¸°ëŠ¥ì€ `examples/` ë””ë ‰í† ë¦¬ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.
